#! /usr/bin/env sclang

// lib/drums_recorder.scd defines the schema for the drum archive
var drumArchivePath = thisProcess.argv[0].absolutePath;
var renderDrumArchive = requireRelative("../nrt_rendering/drum_archive_renderer.scd")[0];

if (("stat " ++ drumArchivePath).unixCmd != 0) {
  "****************************************************************".postln;
  ("Cannot stat drum archive file at " ++ drumArchivePath).postln;
  "Are you sure it exists?".postln;
  "Exiting...".postln;
  "****************************************************************".postln;
  1.exit;
};

drumArchive.keysValuesDo {|name, recordCollection|
  var samplePath = ("../" ++ recordCollection[\relativePath]).resolveRelative;

  renderDrumArchive.value(name, samplePath, noteRecords);
};

0.exit;
